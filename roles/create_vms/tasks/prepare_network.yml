- name: Setup network
  become: true
  block:
    - name: Define network
      community.libvirt.virt_net:
        name: "{{ network_name }}"
        command: define
        xml: "{{ lookup('template', 'network.xml.j2') }}"

    - name: Start network
      community.libvirt.virt_net:
        name: "{{ network_name }}"
        command: start
